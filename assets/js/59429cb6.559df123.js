"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[403],{3404:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>l});var t=i(4848),a=i(8453);const o={sidebar_position:3},s="Examples",r={id:"annealing/examples",title:"Examples",description:"McCormick Function",source:"@site/docs/annealing/examples.md",sourceDirName:"annealing",slug:"/annealing/examples",permalink:"/quickopt/docs/annealing/examples",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Description",permalink:"/quickopt/docs/annealing/description"},next:{title:"References",permalink:"/quickopt/docs/annealing/references"}},c={},l=[{value:"McCormick Function",id:"mccormick-function",level:2}];function m(n){const e={code:"code",h1:"h1",h2:"h2",img:"img",p:"p",pre:"pre",...(0,a.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(e.h2,{id:"mccormick-function",children:"McCormick Function"}),"\n",(0,t.jsxs)(e.p,{children:["The McCormick function is a multimodal function that is commonly used to test optimization algorithms. It is defined as ",(0,t.jsx)(e.code,{children:"f(x,y) = sin(x + y) + (x - y)**2 - 1.5*x + 2.5*y + 1"})," along the domain ",(0,t.jsx)(e.code,{children:"[-1.5, 4] x [-3, 4]"}),". The global minimum of this function is located at ",(0,t.jsx)(e.code,{children:"f(-0.54719, -1.54719) = -1.9133"}),"."]}),"\n",(0,t.jsx)(e.p,{children:"We implement the McCormick function as follows:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import numpy as np\ndef objective(params):\n    x, y = params\n    return np.sin(x + y) + (x - y)**2 - 1.5*x + 2.5*y + 1\n"})}),"\n",(0,t.jsx)(e.p,{children:"We then set our initial guess to the center of the search space:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"initial_guess = [1.25, 0.5]\n"})}),"\n",(0,t.jsx)(e.p,{children:"We define our neighbor function to perturb our current solution by a random normal variable with mean 0 and standard deviation 1:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import random\ndef neighbor(params):\n    new_params = params[:]\n    index = random.randint(0, len(params) - 1)\n    new_params[index] += random.normalvariate(0, 1)\n    new_params[0] = max(-1.5, min(4, new_params[0]))\n    new_params[1] = max(-3, min(4, new_params[0]))\n    return new_params\n"})}),"\n",(0,t.jsx)(e.p,{children:"Finally, we run the simulated annealing algorithm. We choose to run the algorithm for 200 iterations, alongside the default temperature schedule:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from quickopt.annealing import anneal_double\nresult = anneal_double(funct=objective, initial=initial_guess, neighbor=neighbor, iterations=200, verbose=0)\n"})}),"\n",(0,t.jsx)(e.p,{children:"The following is a heatmap of the optimization process, with each point representing a new optimal solution found by the algorithm:"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"Simulated Annealing Optimization Heatmap",src:i(9681).A+"",width:"1000",height:"800"})})]})}function d(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(m,{...n})}):m(n)}},9681:(n,e,i)=>{i.d(e,{A:()=>t});const t=i.p+"assets/images/mc-annealing-3206a2f57ec8efcd2ed04bc8c28d2a66.png"},8453:(n,e,i)=>{i.d(e,{R:()=>s,x:()=>r});var t=i(6540);const a={},o=t.createContext(a);function s(n){const e=t.useContext(o);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:s(n.components),t.createElement(o.Provider,{value:e},n.children)}}}]);